<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Kodi Documentation: Code Guidelines</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Thumbnail-symbol-whitebg-small.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Kodi Documentation<span id="projectnumber">&#160;22.0</span>
   </div>
   <div id="projectbrief">Kodi is an open source media player and entertainment hub.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('df/d02/md__2tmp_2xbmc_2docs_2_c_o_d_e___g_u_i_d_e_l_i_n_e_s.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Code Guidelines</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md1160"></a> <img src="https://github.com/xbmc/xbmc/raw/master/docs/resources/banner_slim.png" alt="Kodi Logo" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md1161"></a>
Table of Contents</h1>
<ul>
<li>1. Motivation</li>
<li>2. Language standard</li>
<li>3. Formatting<ul>
<li>3.1. Braces</li>
<li>3.2. Indentation</li>
<li>3.3. Control statements<ul>
<li>3.3.1. if else</li>
<li>3.3.2. switch case</li>
<li>3.3.3. try catch</li>
</ul>
</li>
<li>3.4. Whitespace</li>
<li>3.5. Vertical alignment</li>
</ul>
</li>
<li>4. Statements</li>
<li>5. Declarations<ul>
<li>5.1. Declarations</li>
<li>5.2. Multiple declarations</li>
<li>5.3. Pointer and reference types</li>
<li>5.4. const and other modifiers</li>
<li>5.5. Initialization</li>
</ul>
</li>
<li>6. Scoping<ul>
<li>6.1. Namespaces</li>
<li>6.2. Local functions</li>
</ul>
</li>
<li>7. Headers<ul>
<li>7.1. Header order</li>
<li>7.2. Use C++ wrappers for C headers</li>
</ul>
</li>
<li>8. Naming<ul>
<li>8.1. Namespaces</li>
<li>8.2. Constants</li>
<li>8.3. Enums</li>
<li>8.4. Interfaces</li>
<li>8.5. Classes</li>
<li>8.6. Structs</li>
<li>8.7. Methods</li>
<li>8.8. Variables<ul>
<li>Member variables</li>
<li>Global variables</li>
</ul>
</li>
</ul>
</li>
<li>9. Comments<ul>
<li>9.1. General</li>
<li>9.2. Doxygen</li>
</ul>
</li>
<li>10. Logging</li>
<li>11. Classes<ul>
<li>11.1. Member visibility</li>
<li>11.2. Const correctness</li>
<li>11.3. Overriding virtual functions</li>
<li>11.4. Default member initialization</li>
<li>11.5. Destructors in interfaces</li>
<li>11.6. Constructor Initialization Lists</li>
</ul>
</li>
<li>12. Other conventions<ul>
<li>12.1. Output parameters</li>
<li>12.2. Casts</li>
<li>12.3. `NULL` vs `nullptr`</li>
<li>12.4. auto</li>
<li>12.5. `for` loops</li>
<li>12.6. Include guards</li>
<li>12.7. Type aliases</li>
<li>12.8. `goto`</li>
<li>12.9. Macros</li>
<li>12.10. constexpr</li>
<li>12.11. `std::string` vs `std::string_view`</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md1162"></a>
1. Motivation</h1>
<p>When working in a large group, the two most important values are readability and maintainability. We code for other people, not computers. To accomplish these goals, we have created a unified set of code conventions.</p>
<p>In the repository root directory, there is a <a href="https://github.com/xbmc/xbmc/blob/master/.clang-format"><code>.clang-format</code></a> file that implements the rules as specified here. You are encouraged to run <a href="https://clang.llvm.org/docs/ClangFormat.html"><code>clang-format</code></a> on any newly created files. It is currently not recommended to do so on preexisting files because all the formatting changes will clutter your commits and pull request.</p>
<p>When you create a pull request, the PR build job will run <code>clang-format</code> on your commits and provide patches for any parts that don't satisfy the current <code>.clang-format</code> rules. You should apply these patches and amend your pull request accordingly.</p>
<p>The coding guidelines should be met by every code change, be it editing existing code, adding new code to existing source files, or adding completely new source files. For changes in existing files, at least the changed code needs to pass the clang-format check.</p>
<p>Conventions can be bent or broken in the interest of making code more readable and maintainable. However, if you submit a patch that contains excessive style conflicts, you may be asked to improve your code before your pull request is reviewed.</p>
<p><b>back to top</b></p>
<h1><a class="anchor" id="autotoc_md1163"></a>
2. Language standard</h1>
<p>We currently target the C++17 language standard. Do use C++17 features when possible (and supported by all target platforms). Do not use C++20 features.</p>
<p><b>back to top</b></p>
<h1><a class="anchor" id="autotoc_md1164"></a>
3. Formatting</h1>
<h2><a class="anchor" id="autotoc_md1165"></a>
Line length</h2>
<p>The <code>ColumnLimit</code> in <code>.clang-format</code> is set to <code>100</code> which defines line length (in general where lines should be broken) that allows two editors side by side on a 1080p screen for diffs.</p>
<h2><a class="anchor" id="autotoc_md1166"></a>
3.1. Braces</h2>
<p>Curly braces always go on a new line.</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../da/da6/_test_c_p_u_info_8cpp.html#a6832d7b762c7dc6b1372508a4f7f5605">t</a>; ++i)</div>
<div class="line">{</div>
<div class="line">  [...]</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (<span class="keyword">true</span>)</div>
<div class="line">{</div>
<div class="line">  [...]</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Dummy</div>
<div class="line">{</div>
<div class="line">  [...]</div>
<div class="line">};</div>
<div class="ttc" id="a_test_c_p_u_info_8cpp_html_a6832d7b762c7dc6b1372508a4f7f5605"><div class="ttname"><a href="../../da/da6/_test_c_p_u_info_8cpp.html#a6832d7b762c7dc6b1372508a4f7f5605">t</a></div><div class="ttdeci">CTemperature t</div><div class="ttdef"><b>Definition</b> TestCPUInfo.cpp:51</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1167"></a>
3.2. Indentation</h2>
<p>Use spaces as tab policy with an indentation size of 2. Opening curly braces increase the level of indentation. Closing curly braces decrease the level of indentation.</p>
<p><b>Exception:</b> Do not indent namespaces to simplify nesting them and wrapping *.cpp* files in a namespace.</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="../../dd/dc7/namespace_k_o_d_i.html">KODI</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="../../d1/dd3/namespace_u_t_i_l_s.html">UTILS</a></div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ILogger</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> Log(...) = 0;</div>
<div class="line">  <span class="keyword">virtual</span> ~ILogger() {}</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line">}</div>
<div class="ttc" id="anamespace_k_o_d_i_html"><div class="ttname"><a href="../../dd/dc7/namespace_k_o_d_i.html">KODI</a></div><div class="ttdef"><b>Definition</b> addons/AudioDecoder.h:19</div></div>
<div class="ttc" id="anamespace_u_t_i_l_s_html"><div class="ttname"><a href="../../d1/dd3/namespace_u_t_i_l_s.html">UTILS</a></div><div class="ttdef"><b>Definition</b> CSSUtils.h:14</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1168"></a>
3.3. Control statements</h2>
<p>Insert a new line before every:</p><ul>
<li>else in an if statement</li>
<li>catch in a try statement</li>
</ul>
<h3><a class="anchor" id="autotoc_md1169"></a>
3.3.1. if else</h3>
<p>Put the consequent on a new line if not in curly braces anyway. Keep <code>else if</code> statements on one line. Do not put a condition and a following statement on a single line.</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><span class="keywordflow">if</span> (<span class="keyword">true</span>)</div>
<div class="line">  <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (<span class="keyword">true</span>)</div>
<div class="line">{</div>
<div class="line">  [...]</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">false</span>)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">  <span class="keywordflow">return</span>;</div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="keywordflow">if</span> (<span class="keyword">true</span>) <span class="keywordflow">return</span>;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md1170"></a>
3.3.2. switch case</h3>
<div class="fragment"><div class="line"><span class="keywordflow">switch</span> (cmd)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">case</span> x:</div>
<div class="line">  {</div>
<div class="line">    doSomething();</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">case</span> x:</div>
<div class="line">  <span class="keywordflow">case</span> z:</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">  <span class="keywordflow">default</span>:</div>
<div class="line">    doSomething();</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md1171"></a>
3.3.3. try catch</h3>
<div class="fragment"><div class="line"><span class="keywordflow">try</span></div>
<div class="line">{</div>
<div class="line">  [...]</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">catch</span> (std::exception&amp; e)</div>
<div class="line">{</div>
<div class="line">  [...]</div>
<div class="line">  <span class="keywordflow">throw</span>;</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">catch</span> (...)</div>
<div class="line">{</div>
<div class="line">  [...]</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1172"></a>
3.4. Whitespace</h2>
<p>Conventional operators have to be surrounded by one space on each side. </p><div class="fragment"><div class="line">a = (b + c) * d;</div>
</div><!-- fragment --><p> Control statement keywords have to be separated from opening parentheses by one space. </p><div class="fragment"><div class="line"><span class="keywordflow">while</span> (<span class="keyword">true</span>);</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; x; ++i);</div>
</div><!-- fragment --><p> When conditions are used without parentheses, it is preferable to add a new line, to make the next block of code more readable. </p><div class="fragment"><div class="line"><span class="keywordflow">if</span> (<span class="keyword">true</span>)</div>
<div class="line">  <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (<span class="keyword">true</span>)</div>
</div><!-- fragment --><p> Commas have to be followed by one space. </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Dummy::Method(<span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b, <span class="keywordtype">int</span> c);</div>
</div><!-- fragment --><p> Initializer lists have one space after each element (including comma), but no surrounding spaces. </p><div class="fragment"><div class="line"><span class="keyword">constexpr</span> <span class="keywordtype">int</span> aNiceArray[] = {1, 2, 3};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1173"></a>
3.5. Vertical alignment</h2>
<p>Do not use whitespace to vertically align around operators or values. This causes problems on code review if one needs to realign all values to their new position, producing unnecessarily large diffs.</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> value1{1};</div>
<div class="line"><span class="keywordtype">int</span> value2{2};</div>
<div class="line">CExampleClass* exampleClass{};</div>
<div class="line">CBiggerExampleClass* biggerExampleClass{};</div>
<div class="line">exampleClass = <span class="keyword">new</span> CExampleClass(value1, value2);</div>
<div class="line">biggerExampleClass = <span class="keyword">new</span> CBiggerExampleClass(value1, value2);</div>
<div class="line">exampleClass-&gt;InitExample();</div>
<div class="line">biggerExampleClass-&gt;InitExample();</div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span>                  value1             {1};</div>
<div class="line"><span class="keywordtype">int</span>                  value2             {2};</div>
<div class="line">[...]</div>
<div class="line">CExampleClass       *exampleClass       {};</div>
<div class="line">CBiggerExampleClass *biggerExampleClass {};</div>
<div class="line">[...]</div>
<div class="line">exampleClass       = <span class="keyword">new</span> CExampleClass      (value1, value2);</div>
<div class="line">biggerExampleClass = <span class="keyword">new</span> CBiggerExampleClass(value1, value2);</div>
<div class="line">[...]</div>
<div class="line">exampleClass      -&gt;InitExample();</div>
<div class="line">biggerExampleClass-&gt;InitExample();</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1174"></a>
3.6. Superfluous &lt;tt&gt;void&lt;/tt&gt;</h2>
<p>Do not write <code>void</code> in empty function parameter declarations.</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Test();</div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Test(<span class="keywordtype">void</span>);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1175"></a>
3.7. Exceptions to the Formatting Rules For Better Readability</h2>
<p>There are some special situations where vertical alignment and longer lines does greatly aid readability, for example the initialization of some table-like multiple row structures. In these <b>rare</b> cases exceptions can be made to the formatting rules on vertical alignment, and the defined line length can be exceeded.</p>
<p>To prevent the layout from being reformatted, tell <code>clang-format</code> to <a href="https://clang.llvm.org/docs/ClangFormatStyleOptions.html#disabling-formatting-on-a-piece-of-code">disable formatting</a> on that section of code by surrounding it with the special comments <code>// clang-format off</code> and <code>// clang-format on</code>. For example: </p><div class="fragment"><div class="line">// clang-format off</div>
<div class="line">static const CGUIDialogMediaFilter::Filter filterList[] = {</div>
<div class="line">  { &quot;movies&quot;,       FieldTitle,         556,    SettingType::String,  &quot;edit&quot;,   &quot;string&quot;,   CDatabaseQueryRule::OPERATOR_CONTAINS },</div>
<div class="line">  { &quot;movies&quot;,       FieldRating,        563,    SettingType::Number,  &quot;range&quot;,  &quot;number&quot;,   CDatabaseQueryRule::OPERATOR_BETWEEN },</div>
<div class="line">  { &quot;movies&quot;,       FieldUserRating,    38018,  SettingType::Integer, &quot;range&quot;,  &quot;integer&quot;,  CDatabaseQueryRule::OPERATOR_BETWEEN },</div>
<div class="line">  ...</div>
<div class="line">  { &quot;songs&quot;,        FieldSource,        39030,  SettingType::List,    &quot;list&quot;,   &quot;string&quot;,   CDatabaseQueryRule::OPERATOR_EQUALS },</div>
<div class="line">};  </div>
<div class="line">// clang-format on</div>
</div><!-- fragment --><p> The other code guidelines will still need to be applied within the delimited lines of code, but with <code>clang-format</code> off care will be needed to check these manually. Using vertical alignment means that sometimes the entire block of code may need to be realigned, good judgement should be used in each case with the objective of preserving readability yet minimising impact.</p>
<p>This is to be used with discretion, marking large amounts of code to be left unformatted by <code>clang-format</code> without reasonable justification will be rejected.</p>
<p><b>back to top</b></p>
<h1><a class="anchor" id="autotoc_md1176"></a>
4. Statements</h1>
<h2><a class="anchor" id="autotoc_md1177"></a>
4.1. Multiple statements</h2>
<p>Do not put multiple statements on a single line. Always use a new line for a new statement. It is much easier to debug if one can pinpoint a precise line number.</p>
<p>✅ Good: </p><div class="fragment"><div class="line">std::vector&lt;std::string&gt; test;</div>
<div class="line">test.push_back(<span class="stringliteral">&quot;foobar&quot;</span>);</div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line">std::vector&lt;std::string&gt; test; test.push_back(<span class="stringliteral">&quot;foobar&quot;</span>);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1178"></a>
4.2. &lt;tt&gt;switch&lt;/tt&gt; default case</h2>
<p>In every <code>switch</code> structure, always include a <code>default</code> case, unless switching on an enum and all enum values are explicitly handled.</p>
<p><b>back to top</b></p>
<h1><a class="anchor" id="autotoc_md1179"></a>
5. Declarations</h1>
<h2><a class="anchor" id="autotoc_md1180"></a>
5.1. Declarations</h2>
<p>Always declare a variable close to its use and not before a block of code that does not use it.</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> x{3};</div>
<div class="line"><a class="code hl_function" href="../../d7/ddf/class_c_log.html#a8b358c304aa1a2a099b594ab60edab9c">CLog::Log</a>(<span class="stringliteral">&quot;test: {}&quot;</span>, x); <span class="comment">// variable used just after its declaration</span></div>
<div class="ttc" id="aclass_c_log_html_a8b358c304aa1a2a099b594ab60edab9c"><div class="ttname"><a href="../../d7/ddf/class_c_log.html#a8b358c304aa1a2a099b594ab60edab9c">CLog::Log</a></div><div class="ttdeci">static void Log(int level, fmt::format_string&lt; Args... &gt; format, Args &amp;&amp;... args)</div><div class="ttdef"><b>Definition</b> log.h:90</div></div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> x{3}; <span class="comment">// variable not immediately used by the next block of code </span></div>
<div class="line">[...many lines of code that <span class="keywordflow">do</span> not use variable x...]</div>
<div class="line"><a class="code hl_function" href="../../d7/ddf/class_c_log.html#a8b358c304aa1a2a099b594ab60edab9c">CLog::Log</a>(<span class="stringliteral">&quot;test: {}&quot;</span>, x);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1181"></a>
5.2. Multiple declarations</h2>
<p>Do not put multiple declarations on a single line. This avoids confusion with differing pointers, references, and initialization values on the same line (cf. <a href="http://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#es10-declare-one-name-only-per-declaration">ISO C++ guidelines</a>).</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><span class="keywordtype">char</span>* a;</div>
<div class="line"><span class="keywordtype">char</span> b;</div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="keywordtype">char</span>* a, b;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1182"></a>
5.3. Pointer and reference types</h2>
<p>Left-align <code>*</code> and <code>&amp;</code> to the base type they modify.</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><span class="keywordtype">char</span>* a;</div>
<div class="line"><span class="keywordtype">void</span> test(<span class="keyword">const</span> std::string&amp; b);</div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="keywordtype">char</span> *a;</div>
<div class="line"><span class="keywordtype">char</span> * b;</div>
<div class="line"><span class="keywordtype">void</span> test(<span class="keyword">const</span> std::string &amp;b);</div>
</div><!-- fragment --><p>(This is adopted from the HP C++ Coding Guidelines: "The characters * and &amp; are to be written with the type of variables instead of with the name of variables in order to emphasize that they are part of the type definition.")</p>
<h2><a class="anchor" id="autotoc_md1183"></a>
5.4. &lt;tt&gt;const&lt;/tt&gt; and other modifiers</h2>
<p>Place <code>const</code> and similar modifiers in front of the type they modify.</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Test(<span class="keyword">const</span> std::string&amp; a);</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span>* <span class="keyword">const</span> someIntPointer;</div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Test(std::string <span class="keyword">const</span>&amp; a);</div>
<div class="line"><span class="keywordtype">int</span> <span class="keyword">const</span> * <span class="keyword">const</span> someIntPointer;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1184"></a>
5.5. Initialization</h2>
<p>Make sure that variables are initialized appropriately at declaration or soon afterwards. This is especially important for fundamental type variables that do not have any constructor. Zero-initialize with <code>{}</code>.</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> x{3};</div>
<div class="line"><span class="keywordtype">int</span>* y{<span class="keyword">nullptr</span>};</div>
<div class="line"><span class="keywordtype">bool</span> z = <span class="keyword">false</span>;</div>
<div class="line">std::string <a class="code hl_property" href="../../d4/d39/_speech_recognition_darwin_8mm.html#a34710a06f8d45c8629e5628fc241f376">text</a>; <span class="comment">// not primitive</span></div>
<div class="line">KindOfStruct theStruct{}; <span class="comment">// POD structures or structures with uninitalised members must be initialised with empty brackets</span></div>
<div class="line">Log::Log(<span class="stringliteral">&quot;test: {}, {}, {}&quot;</span>, x, y, z);</div>
<div class="ttc" id="a_speech_recognition_darwin_8mm_html_a34710a06f8d45c8629e5628fc241f376"><div class="ttname"><a href="../../d4/d39/_speech_recognition_darwin_8mm.html#a34710a06f8d45c8629e5628fc241f376">text</a></div><div class="ttdeci">NSString * text</div><div class="ttdef"><b>Definition</b> SpeechRecognitionDarwin.mm:32</div></div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> x; <span class="comment">// used uninitialized</span></div>
<div class="line"><span class="keywordtype">int</span>* y = <span class="keyword">nullptr</span>; <span class="comment">// default-initialization not using {}</span></div>
<div class="line"><span class="keywordtype">bool</span> z{}; <span class="comment">// no value explicitly declared for fundamental type, preferable for better reading</span></div>
<div class="line">std::string <a class="code hl_property" href="../../d4/d39/_speech_recognition_darwin_8mm.html#a34710a06f8d45c8629e5628fc241f376">text</a>{}; <span class="comment">// has its default constructor</span></div>
<div class="line">Log::Log(<span class="stringliteral">&quot;test: {}, {}, {}&quot;</span>, x, y, z);</div>
</div><!-- fragment --><p>We allow variable initialization using any of the C++ forms <code>{}</code>, <code>=</code> or <code>()</code>.</p>
<p>However, we would like to point out some optional suggestions to follow:</p><ul>
<li>Prefer the <code>{}</code> form to others, because this permits explicit type checking to avoid unwanted narrowing conversions.</li>
<li>Prefer the <code>{}</code> form when initializing a class/struct variable.</li>
<li>Specify an explicit initialization value, at least for fundamental types.</li>
</ul>
<p><b>back to top</b></p>
<h1><a class="anchor" id="autotoc_md1185"></a>
6. Scoping</h1>
<h2><a class="anchor" id="autotoc_md1186"></a>
6.1. Namespaces</h2>
<p>Try to put all code into appropriate namespaces (e.g. following directory structure) and avoid polluting the global namespace.</p>
<h2><a class="anchor" id="autotoc_md1187"></a>
6.2. Local functions</h2>
<p>Put functions local to a compilation unit into an anonymous namespace.</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><span class="keyword">namespace</span></div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test();</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// unnamed namespace</span></div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> test();</div>
</div><!-- fragment --><p><b>back to top</b></p>
<h1><a class="anchor" id="autotoc_md1188"></a>
7. Headers</h1>
<h2><a class="anchor" id="autotoc_md1189"></a>
7.1. Header order</h2>
<p>Included header files have to be sorted (case sensitive) alphabetically to prevent duplicates and allow better overview, with an empty line clearly separating sections.</p>
<p>Header order has to be:</p><ul>
<li>Own header file</li>
<li>Other Kodi includes (platform independent)</li>
<li>Other Kodi includes (platform specific)</li>
<li>C and C++ system files</li>
<li>Other libraries' header files</li>
<li>special Kodi headers (PlatformDefs.h, system.h and <a class="el" href="../../de/d72/system__gl_8h.html">system_gl.h</a>)</li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../da/d5c/_p_v_r_manager_8h.html">PVRManager.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d9/da3/_application_8h.html">Application.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d3/dc3/_service_broker_8h.html">ServiceBroker.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../df/dd1/_addon_installer_8h.html">addons/AddonInstaller.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../de/dc2/_g_u_i_dialog_extended_progress_bar_8h.html">dialogs/GUIDialogExtendedProgressBar.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../db/d55/_application_messenger_8h.html">messaging/ApplicationMessenger.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../df/d39/_thread_message_8h.html">messaging/ThreadMessage.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../da/d64/_dialog_helper_8h.html">messaging/helpers/DialogHelper.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d0/dc6/_music_database_8h.html">music/MusicDatabase.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d1/da1/_music_info_tag_8h.html">music/tags/MusicInfoTag.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d0/d88/network_2_network_8h.html">network/Network.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../de/d3d/_p_v_r_clients_8h.html">pvr/addons/PVRClients.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../df/db7/_p_v_r_channel_8h.html">pvr/channels/PVRChannel.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../db/dde/settings_2_settings_8h.html">settings/Settings.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../df/d57/_single_lock_8h.html">threads/SingleLock.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../db/db9/_job_manager_8h.html">utils/JobManager.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d2/d19/_variant_8h.html">utils/Variant.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d7/d7f/log_8h.html">utils/log.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d9/d1c/_video_database_8h.html">video/VideoDatabase.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;libavutil/pixfmt.h&gt;</span></div>
<div class="ttc" id="a_addon_installer_8h_html"><div class="ttname"><a href="../../df/dd1/_addon_installer_8h.html">AddonInstaller.h</a></div></div>
<div class="ttc" id="a_application_8h_html"><div class="ttname"><a href="../../d9/da3/_application_8h.html">Application.h</a></div></div>
<div class="ttc" id="a_application_messenger_8h_html"><div class="ttname"><a href="../../db/d55/_application_messenger_8h.html">ApplicationMessenger.h</a></div></div>
<div class="ttc" id="a_dialog_helper_8h_html"><div class="ttname"><a href="../../da/d64/_dialog_helper_8h.html">DialogHelper.h</a></div></div>
<div class="ttc" id="a_g_u_i_dialog_extended_progress_bar_8h_html"><div class="ttname"><a href="../../de/dc2/_g_u_i_dialog_extended_progress_bar_8h.html">GUIDialogExtendedProgressBar.h</a></div></div>
<div class="ttc" id="a_job_manager_8h_html"><div class="ttname"><a href="../../db/db9/_job_manager_8h.html">JobManager.h</a></div></div>
<div class="ttc" id="a_music_database_8h_html"><div class="ttname"><a href="../../d0/dc6/_music_database_8h.html">MusicDatabase.h</a></div></div>
<div class="ttc" id="a_music_info_tag_8h_html"><div class="ttname"><a href="../../d1/da1/_music_info_tag_8h.html">MusicInfoTag.h</a></div></div>
<div class="ttc" id="a_p_v_r_channel_8h_html"><div class="ttname"><a href="../../df/db7/_p_v_r_channel_8h.html">PVRChannel.h</a></div></div>
<div class="ttc" id="a_p_v_r_clients_8h_html"><div class="ttname"><a href="../../de/d3d/_p_v_r_clients_8h.html">PVRClients.h</a></div></div>
<div class="ttc" id="a_p_v_r_manager_8h_html"><div class="ttname"><a href="../../da/d5c/_p_v_r_manager_8h.html">PVRManager.h</a></div></div>
<div class="ttc" id="a_service_broker_8h_html"><div class="ttname"><a href="../../d3/dc3/_service_broker_8h.html">ServiceBroker.h</a></div></div>
<div class="ttc" id="a_single_lock_8h_html"><div class="ttname"><a href="../../df/d57/_single_lock_8h.html">SingleLock.h</a></div></div>
<div class="ttc" id="a_thread_message_8h_html"><div class="ttname"><a href="../../df/d39/_thread_message_8h.html">ThreadMessage.h</a></div></div>
<div class="ttc" id="a_variant_8h_html"><div class="ttname"><a href="../../d2/d19/_variant_8h.html">Variant.h</a></div></div>
<div class="ttc" id="a_video_database_8h_html"><div class="ttname"><a href="../../d9/d1c/_video_database_8h.html">VideoDatabase.h</a></div></div>
<div class="ttc" id="alog_8h_html"><div class="ttname"><a href="../../d7/d7f/log_8h.html">log.h</a></div></div>
<div class="ttc" id="anetwork_2_network_8h_html"><div class="ttname"><a href="../../d0/d88/network_2_network_8h.html">Network.h</a></div></div>
<div class="ttc" id="asettings_2_settings_8h_html"><div class="ttname"><a href="../../db/dde/settings_2_settings_8h.html">Settings.h</a></div></div>
</div><!-- fragment --><p>If the headers aren't sorted, either do your best to match the existing order, or precede your commit with an alphabetization commit.</p>
<p>If possible, avoid including headers in another header. Instead, you can forward-declare the class and use a <code>std::unique_ptr</code> (or similar):</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_class" href="../../df/d79/class_c_file_item.html">CFileItem</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Example</div>
<div class="line">{</div>
<div class="line">  ...</div>
<div class="line">  std::unique_ptr&lt;CFileItem&gt; m_fileItem;</div>
<div class="line">}</div>
<div class="ttc" id="aclass_c_file_item_html"><div class="ttname"><a href="../../df/d79/class_c_file_item.html">CFileItem</a></div><div class="ttdoc">Represents a file on a share.</div><div class="ttdef"><b>Definition</b> FileItem.h:105</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1190"></a>
7.2. Use C++ wrappers for C headers</h2>
<p>To use C symbols use C++ wrappers headers, by using the <code>std</code> namespace prefix.</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;cstring&gt;</span></div>
<div class="line">[...]</div>
<div class="line"><span class="keywordtype">size_t</span> n = std::strlen(str);</div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span> <span class="comment">// C header</span></div>
<div class="line">[...]</div>
<div class="line"><span class="keywordtype">size_t</span> n = strlen(str); <span class="comment">// missing std namespace</span></div>
</div><!-- fragment --><p><b>back to top</b></p>
<h1><a class="anchor" id="autotoc_md1191"></a>
8. Naming</h1>
<h2><a class="anchor" id="autotoc_md1192"></a>
8.1. Namespaces</h2>
<p>Use upper case with underscores. </p><div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="../../dd/dc7/namespace_k_o_d_i.html">KODI</a></div>
<div class="line">{</div>
<div class="line">[...]</div>
<div class="line">} <span class="comment">// namespace KODI</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1193"></a>
8.2. Constants</h2>
<p>Use upper case with underscores. </p><div class="fragment"><div class="line"><span class="keyword">constexpr</span> <span class="keywordtype">int</span> MY_CONSTANT = 1;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1194"></a>
8.3. Enums</h2>
<p>Use PascalCase for the enum name and upper case with underscores for the values. </p><div class="fragment"><div class="line"><span class="keyword">enum class</span> Dummy</div>
<div class="line">{</div>
<div class="line">  VALUE_X,</div>
<div class="line">  VALUE_Y</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1195"></a>
8.4. Interfaces</h2>
<p>Use PascalCase and prefix with an uppercase I. Filename has to match the interface name without the prefixed I, e.g. Logger.h </p><div class="fragment"><div class="line"><span class="keyword">class </span>ILogger</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> Log(...) = 0;</div>
<div class="line">  <span class="keyword">virtual</span> ~ILogger() {}</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1196"></a>
8.5. Classes</h2>
<p>Use PascalCase and prefix with an uppercase C. Filename has to match the class name without the prefixed C, e.g. Logger.cpp </p><div class="fragment"><div class="line"><span class="keyword">class </span>CLogger : <span class="keyword">public</span> ILogger</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keywordtype">void</span> Log(...) <span class="keyword">override</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1197"></a>
8.6. Structs</h2>
<p>Use PascalCase. </p><div class="fragment"><div class="line"><span class="keyword">struct </span>InfoChar</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">bool</span> m_isBold{<span class="keyword">false</span>};</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1198"></a>
8.7. Methods</h2>
<p>Use PascalCase always, uppercasing the first letter even if the methods are private or protected. Method parameters start with lower case and follow CamelCase style, without type prefixing (Systems Hungarian notation). </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> MyDummyClass::DoSomething(<span class="keywordtype">int</span> limitBound);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1199"></a>
8.8. Variables</h2>
<p>Variables start with lower case and follow CamelCase style. Type prefixing (Systems Hungarian notation) is discouraged.</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><span class="keywordtype">bool</span> isSunYellow{<span class="keyword">true</span>};</div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="keywordtype">bool</span> bSunYellow{<span class="keyword">true</span>}; <span class="comment">// type prefixing</span></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md1200"></a>
Member variables</h3>
<p>Prefix non-static member variables with <code>m_</code>. Prefix static member variables with <code>ms_</code>. </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> m_variableA;</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> ms_variableB;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md1201"></a>
Global variables</h3>
<p>Prefix global variables with <code>g_</code> </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> g_globalVariableA;</div>
</div><!-- fragment --><blockquote class="doxtable">
<p>&zwj;[!WARNING] <br  />
 Avoid use of globals as far as reasonably possible. We generally do not want to introduce new global variables. </p>
</blockquote>
<p><b>back to top</b></p>
<h1><a class="anchor" id="autotoc_md1202"></a>
9. Comments</h1>
<h2><a class="anchor" id="autotoc_md1203"></a>
9.1. General</h2>
<p>Use <code>//</code> for inline single-line and multi-line comments. Use <code>/* */</code> for the copyright comment at the beginning of the file. SPDX license headers are required for all code files (see example below).</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> *  Copyright (C) 2005-2018 Team Kodi</span></div>
<div class="line"><span class="comment"> *  This file is part of Kodi - https://kodi.tv</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  SPDX-License-Identifier: GPL-2.0-or-later</span></div>
<div class="line"><span class="comment"> *  See LICENSES/README.md for more information.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Nice comment</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// This can also continue for multiple lines:</span></div>
<div class="line"><span class="comment">// I am the second line.</span></div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="comment">/* A comment */</span></div>
<div class="line"><span class="comment">//another comment</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1204"></a>
9.2. Doxygen</h2>
<p>New classes and functions are expected to have Doxygen comments describing their purpose, parameters, and behavior in the header file. However, do not describe trivialities - it only adds visual noise. Use the Qt style with exclamation mark (<code>/*! */</code>) and backslash for doxygen commands (e.g. <code>\brief</code>).</p>
<p>✅ Good: </p><div class="fragment"><div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> OutputIt&gt;</div>
<div class="line"><span class="keyword">static</span> OutputIt SplitTo(OutputIt destination, <span class="keyword">const</span> std::string&amp; input, <span class="keyword">const</span> std::string&amp; delimiter, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxStrings = 0);</div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> TestFunction();</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> ReallyComplicatedFunction(); <span class="comment">// does something really complicated</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> Frobnicate(<span class="keywordtype">int</span> param);</div>
</div><!-- fragment --><p><b>back to top</b></p>
<h1><a class="anchor" id="autotoc_md1205"></a>
10. Logging</h1>
<p>Use the provided logging function <code><a class="el" href="../../d7/ddf/class_c_log.html#a8b358c304aa1a2a099b594ab60edab9c">CLog::Log</a></code>. Do not log to standard output or standard error using e.g. <code>printf</code> or <code>std::cout</code>.</p>
<p>The <code>Log</code> function uses the <a href="http://fmtlib.net/">fmt library</a> for formatting log messages. Basically, you can use <code>{}</code> as placeholder for anything and list the parameters to insert after the message similarly to <code>printf</code>. See <a href="http://fmtlib.net/latest/syntax.html">here</a> for the detailed syntax and below for an example.</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><a class="code hl_function" href="../../d7/ddf/class_c_log.html#a8b358c304aa1a2a099b594ab60edab9c">CLog::Log</a>(<a class="code hl_variable" href="../../dc/d73/ilog_8h.html#a74224895f66cf67ff1ab4923f8c6f180">LOGDEBUG</a>, <span class="stringliteral">&quot;Window size: {}x{}&quot;</span>, <a class="code hl_typedef" href="../../d0/d3b/kodi-dev-kit_2include_2kodi_2c-api_2addon-instance_2imagedecoder_8h.html#ae7cec55283f55141a572358f21aca0fa">width</a>, <a class="code hl_typedef" href="../../d0/d3b/kodi-dev-kit_2include_2kodi_2c-api_2addon-instance_2imagedecoder_8h.html#ab65f561b32b759efc5d06baeb384eefb">height</a>);</div>
<div class="line">CLog::LogF(<a class="code hl_variable" href="../../dc/d73/ilog_8h.html#ac3a15901fd7945a8f153cbb5d221048c">LOGERROR</a>, <span class="stringliteral">&quot;An error occurred in window \&quot;{}\&quot;&quot;</span>, <a class="code hl_variable" href="../../d8/d4c/addon__base_8h.html#a399367e431a6941e632f4a9631e8b64e">name</a>); <span class="comment">// Use helper function `CLog::LogF` to print also the name of method.</span></div>
<div class="ttc" id="aaddon__base_8h_html_a399367e431a6941e632f4a9631e8b64e"><div class="ttname"><a href="../../d8/d4c/addon__base_8h.html#a399367e431a6941e632f4a9631e8b64e">name</a></div><div class="ttdeci">enum const char * name</div><div class="ttdef"><b>Definition</b> addon_base.h:203</div></div>
<div class="ttc" id="ailog_8h_html_a74224895f66cf67ff1ab4923f8c6f180"><div class="ttname"><a href="../../dc/d73/ilog_8h.html#a74224895f66cf67ff1ab4923f8c6f180">LOGDEBUG</a></div><div class="ttdeci">constexpr int LOGDEBUG</div><div class="ttdef"><b>Definition</b> ilog.h:18</div></div>
<div class="ttc" id="ailog_8h_html_ac3a15901fd7945a8f153cbb5d221048c"><div class="ttname"><a href="../../dc/d73/ilog_8h.html#ac3a15901fd7945a8f153cbb5d221048c">LOGERROR</a></div><div class="ttdeci">constexpr int LOGERROR</div><div class="ttdef"><b>Definition</b> ilog.h:21</div></div>
<div class="ttc" id="akodi-dev-kit_2include_2kodi_2c-api_2addon-instance_2imagedecoder_8h_html_ab65f561b32b759efc5d06baeb384eefb"><div class="ttname"><a href="../../d0/d3b/kodi-dev-kit_2include_2kodi_2c-api_2addon-instance_2imagedecoder_8h.html#ab65f561b32b759efc5d06baeb384eefb">height</a></div><div class="ttdeci">const char const uint8_t size_t unsigned int unsigned int * height</div><div class="ttdef"><b>Definition</b> kodi-dev-kit/include/kodi/c-api/addon-instance/imagedecoder.h:417</div></div>
<div class="ttc" id="akodi-dev-kit_2include_2kodi_2c-api_2addon-instance_2imagedecoder_8h_html_ae7cec55283f55141a572358f21aca0fa"><div class="ttname"><a href="../../d0/d3b/kodi-dev-kit_2include_2kodi_2c-api_2addon-instance_2imagedecoder_8h.html#ae7cec55283f55141a572358f21aca0fa">width</a></div><div class="ttdeci">const char const uint8_t size_t unsigned int * width</div><div class="ttdef"><b>Definition</b> kodi-dev-kit/include/kodi/c-api/addon-instance/imagedecoder.h:416</div></div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><a class="code hl_function" href="../../d7/ddf/class_c_log.html#a8b358c304aa1a2a099b594ab60edab9c">CLog::Log</a>(<a class="code hl_variable" href="../../dc/d73/ilog_8h.html#a18eb84bf3ecbe438040743c50ce28677">LOGWARNING</a>, <span class="stringliteral">&quot;Window size: %dx%d&quot;</span>, <a class="code hl_typedef" href="../../d0/d3b/kodi-dev-kit_2include_2kodi_2c-api_2addon-instance_2imagedecoder_8h.html#ae7cec55283f55141a572358f21aca0fa">width</a>, <a class="code hl_typedef" href="../../d0/d3b/kodi-dev-kit_2include_2kodi_2c-api_2addon-instance_2imagedecoder_8h.html#ab65f561b32b759efc5d06baeb384eefb">height</a>); <span class="comment">// printf-style format strings are possible, but discouraged; also the message does not warrant the warning level</span></div>
<div class="line"><a class="code hl_function" href="../../d7/ddf/class_c_log.html#a8b358c304aa1a2a099b594ab60edab9c">CLog::Log</a>(<a class="code hl_variable" href="../../dc/d73/ilog_8h.html#ac3a15901fd7945a8f153cbb5d221048c">LOGERROR</a>, <span class="stringliteral">&quot;{}: An error occurred in window \&quot;{}\&quot;&quot;</span>, __FUNCTION__, <a class="code hl_variable" href="../../d8/d4c/addon__base_8h.html#a399367e431a6941e632f4a9631e8b64e">name</a>); <span class="comment">// Do not use __FUNCTION__ macro, use `CLog::LogF` instead.</span></div>
<div class="line">printf(<span class="stringliteral">&quot;Window size: %dx%d&quot;</span>, <a class="code hl_typedef" href="../../d0/d3b/kodi-dev-kit_2include_2kodi_2c-api_2addon-instance_2imagedecoder_8h.html#ae7cec55283f55141a572358f21aca0fa">width</a>, <a class="code hl_typedef" href="../../d0/d3b/kodi-dev-kit_2include_2kodi_2c-api_2addon-instance_2imagedecoder_8h.html#ab65f561b32b759efc5d06baeb384eefb">height</a>);</div>
<div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot;Window size: &quot;</span> &lt;&lt; <a class="code hl_typedef" href="../../d0/d3b/kodi-dev-kit_2include_2kodi_2c-api_2addon-instance_2imagedecoder_8h.html#ae7cec55283f55141a572358f21aca0fa">width</a> &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; <a class="code hl_typedef" href="../../d0/d3b/kodi-dev-kit_2include_2kodi_2c-api_2addon-instance_2imagedecoder_8h.html#ab65f561b32b759efc5d06baeb384eefb">height</a> &lt;&lt; std::endl;</div>
<div class="ttc" id="ailog_8h_html_a18eb84bf3ecbe438040743c50ce28677"><div class="ttname"><a href="../../dc/d73/ilog_8h.html#a18eb84bf3ecbe438040743c50ce28677">LOGWARNING</a></div><div class="ttdeci">constexpr int LOGWARNING</div><div class="ttdef"><b>Definition</b> ilog.h:20</div></div>
</div><!-- fragment --><p>The predefined logging levels are <code>DEBUG</code>, <code><a class="el" href="../../d9/d25/namespace_i_n_f_o.html">INFO</a></code>, <code>WARNING</code>, <code>ERROR</code>, and <code>FATAL</code>. Use anything <code><a class="el" href="../../d9/d25/namespace_i_n_f_o.html">INFO</a></code> and above sparingly since it will be written to the log by default. Too many messages will clutter the log and reduce visibility of important information. <code>DEBUG</code> messages are only written when debug logging is enabled.</p>
<h1><a class="anchor" id="autotoc_md1206"></a>
11. Classes</h1>
<h2><a class="anchor" id="autotoc_md1207"></a>
11.1. Member visibility</h2>
<p>Make class data members <code>private</code>. Think twice before using <code>protected</code> for data members and functions, as its level of encapsulation is effectively equivalent to <code>public</code>.</p>
<h2><a class="anchor" id="autotoc_md1208"></a>
11.2. Const correctness</h2>
<p>Try to mark member functions of classes as <code>const</code> whenever reasonable.</p>
<h2><a class="anchor" id="autotoc_md1209"></a>
11.3. Overriding virtual functions</h2>
<p>When overriding virtual functions of a base class, add the <code>override</code> keyword. Do not add the <code>virtual</code> keyword.</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><span class="keyword">class </span>CLogger : <span class="keyword">public</span> ILogger</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keywordtype">void</span> Log(...) <span class="keyword">override</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="keyword">class </span>CLogger : <span class="keyword">public</span> ILogger</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> Log(...) <span class="keyword">override</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1210"></a>
11.4. Default member initialization</h2>
<p>Use default member initialization instead of initializer lists or constructor assignments whenever it makes sense. </p><div class="fragment"><div class="line"><span class="keyword">class </span>Foo</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">bool</span> m_fooBar{<span class="keyword">false</span>};</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1211"></a>
11.5. Destructors in interfaces</h2>
<p>A class with any virtual functions should have a destructor that is either public and virtual or else protected and non-virtual (cf. <a href="http://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#Rc-dtor-virtual">ISO C++ guidelines</a>).</p>
<h2><a class="anchor" id="autotoc_md1212"></a>
11.6. Constructor Initialization Lists</h2>
<p>For lines up to line length everything stays on one line, excluding the braces which must be on the following lines.</p>
<div class="fragment"><div class="line">MyClass::CMyClass(<span class="keywordtype">bool</span> argOne, <span class="keywordtype">int</span> argTwo) : m_argOne(argOne), m_argTwo(argTwo)</div>
<div class="line">{</div>
<div class="line">}</div>
</div><!-- fragment --><p>For longer lines, insert a line break before the colon and/or after the comma.</p>
<div class="fragment"><div class="line">MyClass::CMyClass(<span class="keywordtype">bool</span> argOne,</div>
<div class="line">                  <span class="keywordtype">int</span> argTwo,</div>
<div class="line">                  <span class="keyword">const</span> std::string&amp; textArg,</div>
<div class="line">                  <span class="keyword">const</span> std::shared_ptr&lt;CMyOtherClass&gt;&amp; myOtherClass)</div>
<div class="line">  : m_argOne(argOne),</div>
<div class="line">    m_argTwo(argTwo),</div>
<div class="line">    m_textArg(textArg),</div>
<div class="line">    m_myOtherClass(myOtherClass)</div>
<div class="line">{</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1213"></a>
12. Other conventions</h1>
<h2><a class="anchor" id="autotoc_md1214"></a>
12.1. Output parameters</h2>
<p>For functions that have multiple output values, prefer using a <code>struct</code> or <code>tuple</code> return value over output parameters that use pointers or references (cf. <a href="http://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#Rf-out-multi">ISO C++ guidelines</a>). In general, try to avoid output parameters completely (cf. <a href="http://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#Rf-out">ISO C++ guidelines</a>, <a href="https://google.github.io/styleguide/cppguide.html#Output_Parameters">Google C++ Style Guide</a>). At the function call site, it is completely invisible that actually a reference is being passed and the value might be modified. Return semantics make it clear what is happening.</p>
<h2><a class="anchor" id="autotoc_md1215"></a>
12.2. Casts</h2>
<p>New code has to use C++ style casts and not older C style casts. When modifying existing code the developer can choose to update it to C++ style casts or leave as is. Whenever a <code>dynamic_cast</code> is used to cast to a pointer type, the result can be <code>nullptr</code> and needs to be checked accordingly.</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><span class="keywordtype">char</span> m_dataChar{...};</div>
<div class="line"><a class="code hl_typedef" href="../../d2/d54/_direct_x_graphics_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> m_dataInt = <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="../../d2/d54/_direct_x_graphics_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a><span class="keyword">&gt;</span>(m_dataChar);</div>
<div class="ttc" id="a_direct_x_graphics_8h_html_a9a941819355e6f658991890ff66b4b0e"><div class="ttname"><a href="../../d2/d54/_direct_x_graphics_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a></div><div class="ttdeci">unsigned __int8 uint8_t</div><div class="ttdef"><b>Definition</b> DirectXGraphics.h:130</div></div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="keywordtype">char</span> m_dataChar{...};</div>
<div class="line"><a class="code hl_typedef" href="../../d2/d54/_direct_x_graphics_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> m_dataInt = (<a class="code hl_typedef" href="../../d2/d54/_direct_x_graphics_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a>)m_dataChar;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1216"></a>
12.3. &lt;tt&gt;NULL&lt;/tt&gt; vs &lt;tt&gt;nullptr&lt;/tt&gt;</h2>
<p>Prefer the use of <code>nullptr</code> instead of <code>NULL</code>. <code>nullptr</code> is a typesafe version and as such can't be implicitly converted to <code>int</code> or anything else.</p>
<h2><a class="anchor" id="autotoc_md1217"></a>
12.4. &lt;tt&gt;auto&lt;/tt&gt;</h2>
<p>Feel free to use <code>auto</code> wherever it improves readability, without abusing it when it is not the case.</p><ul>
<li>Good places are iterators or types that have multiple sub-levels in a namespace.</li>
<li>Bad places are code that expects a certain type that is not immediately clear from the context, or when you declare fundamental types.</li>
</ul>
<p>✅ Good: </p><div class="fragment"><div class="line">[...]</div>
<div class="line"><span class="keyword">constexpr</span> <span class="keywordtype">float</span> START_POINT = 5;</div>
<div class="line">[...]</div>
<div class="line"><span class="keyword">auto</span> i = var.begin();</div>
<div class="line"> </div>
<div class="line">std::vector&lt;CSizeInt&gt; list;</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> j : list)</div>
<div class="line">{</div>
<div class="line">  [...]</div>
<div class="line">}</div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line">[...]</div>
<div class="line"><span class="keyword">constexpr</span> <span class="keyword">auto</span> START_POINT = 5; <span class="comment">// may cause problems due to wrong type deduced, many auto variables make reading difficult</span></div>
<div class="line">[...]</div>
<div class="line">std::map&lt;std::string, std::vector&lt;int&gt;&gt;::iterator i = var.begin();</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1218"></a>
12.5. &lt;tt&gt;for&lt;/tt&gt; loops</h2>
<p>Use range-based for loops wherever it makes sense. If iterators are used, see above about using <code>auto</code>. </p><div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; : var)</div>
<div class="line">{</div>
<div class="line">  [...]</div>
<div class="line">}</div>
</div><!-- fragment --><p> Remove <code>const</code> if the value has to be modified. Do not use references to fundamental types that are not modified.</p>
<p>In traditional for loops, for the <code>increment statement</code> of the loop, use prefix increment/decrement operator, not postfix.</p>
<p>✅ Good: </p><div class="fragment"><div class="line">[...]</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 100; ++i)</div>
<div class="line">{</div>
<div class="line">  [...]</div>
<div class="line">}</div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 100; i++)</div>
<div class="line">{</div>
<div class="line">  [...]</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1219"></a>
12.6. Include guards</h2>
<p>Use <code>#pragma once</code>.</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><span class="preprocessor">#pragma once</span></div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="preprocessor">#ifndef SOME_FILE_H_INCLUDED</span></div>
<div class="line"><span class="preprocessor">#define SOME_FILE_H_INCLUDED</span></div>
<div class="line">[...]</div>
<div class="line"><span class="preprocessor">#endif</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1220"></a>
12.7. Type aliases</h2>
<p>Use the C++ <code>using</code> syntax when aliasing types (encouraged when it improves readability).</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><span class="keyword">using </span>SizeType = <a class="code hl_typedef" href="../../df/df1/kodi-dev-kit_2include_2kodi_2c-api_2addon-instance_2_visualization_8h.html#a0832153a8b372b76773317b799e5f51a">int</a>;</div>
<div class="ttc" id="akodi-dev-kit_2include_2kodi_2c-api_2addon-instance_2_visualization_8h_html_a0832153a8b372b76773317b799e5f51a"><div class="ttname"><a href="../../df/df1/kodi-dev-kit_2include_2kodi_2c-api_2addon-instance_2_visualization_8h.html#a0832153a8b372b76773317b799e5f51a">int</a></div><div class="ttdeci">unsigned int(ATTR_APIENTRYP PFN_KODI_ADDON_VISUALIZATION_GET_PRESETS_V1)(const KODI_ADDON_VISUALIZATION_HDL hdl)</div><div class="ttdef"><b>Definition</b> kodi-dev-kit/include/kodi/c-api/addon-instance/Visualization.h:73</div></div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keywordtype">int</span> SizeType;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1221"></a>
12.8. &lt;tt&gt;goto&lt;/tt&gt;</h2>
<p>Usage of <code>goto</code> is discouraged.</p>
<h2><a class="anchor" id="autotoc_md1222"></a>
12.9. Macros</h2>
<p>Try to avoid using C macros. In many cases, they can be easily substituted with other non-macro constructs.</p>
<h2><a class="anchor" id="autotoc_md1223"></a>
12.10. &lt;tt&gt;constexpr&lt;/tt&gt;</h2>
<p>Prefer <code>constexpr</code> over <code>const</code> for constants when possible. Try to mark functions <code>constexpr</code> when reasonable.</p>
<h2><a class="anchor" id="autotoc_md1224"></a>
12.11. &lt;tt&gt;std::string&lt;/tt&gt; vs &lt;tt&gt;std::string_view&lt;/tt&gt;</h2>
<p>Prefer <code>std::string_view</code> over <code>std::string</code> when reasonable. Good examples are constants or method arguments. In the latter case, it is not required to declare the argument as reference or const, since the data source of string views are immutable by definition. A bad example is when you need a NUL-terminated C string, e.g. to interact with a C API. <code>std::string_view</code> does not offer a <code>c_str()</code> function like <code>std::string</code> does, but if you do not need a C string you can use <code><a class="el" href="../../d6/dff/_test_x_b_m_c_tiny_x_m_l2_8cpp.html#affb8bb1e6db791e30eaf9c6814e0a146">data()</a></code> to get the raw source of the data.</p>
<p>Main reasons why we prefer <code>std::string_view</code> are: execution performance, no memory allocations, substrings can be made without copy, and the possibility to reuse the same data without reallocation.</p>
<p>Avoid using <code>std::string_view</code> when you are not sure where the source of data is allocated, or as return value of a method. If not handled properly, the source (storage) of the data may go out of scope. As a consequence, the program enters undefined behavior and may crash, behave strangely, or introduce potential security issues.</p>
<p>✅ Good: </p><div class="fragment"><div class="line"><span class="keyword">namespace</span></div>
<div class="line">{</div>
<div class="line"><span class="keyword">constexpr</span> std::string_view CONSTANT_FOO{<span class="stringliteral">&quot;foo-bar&quot;</span>};</div>
<div class="line">} <span class="comment">// unnamed namespace</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> CClass::SetText(std::string_view <a class="code hl_variable" href="../../d8/d4c/addon__base_8h.html#a6036ce391edec2455b498536dc4ea03d">value</a>) </div>
<div class="line">{</div>
<div class="line">  CLog::LogF(<a class="code hl_variable" href="../../dc/d73/ilog_8h.html#a74224895f66cf67ff1ab4923f8c6f180">LOGDEBUG</a>, <span class="stringliteral">&quot;My name is {}&quot;</span>, <a class="code hl_variable" href="../../d8/d4c/addon__base_8h.html#a6036ce391edec2455b498536dc4ea03d">value</a>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">[...]</div>
<div class="line">SetText(CONSTANT_FOO.substr(0, 3)); <span class="comment">// substr returns a modified view of the same string_view, thus without allocations</span></div>
<div class="ttc" id="aaddon__base_8h_html_a6036ce391edec2455b498536dc4ea03d"><div class="ttname"><a href="../../d8/d4c/addon__base_8h.html#a6036ce391edec2455b498536dc4ea03d">value</a></div><div class="ttdeci">enum const char const char * value</div><div class="ttdef"><b>Definition</b> addon_base.h:203</div></div>
</div><!-- fragment --><p>❌ Bad: </p><div class="fragment"><div class="line"><span class="keyword">namespace</span></div>
<div class="line">{</div>
<div class="line"><span class="keyword">constexpr</span> std::string CONSTANT_FOO{<span class="stringliteral">&quot;foo-bar&quot;</span>}; <span class="comment">// using string_view will avoid a memory allocation </span></div>
<div class="line">} <span class="comment">// unnamed namespace</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> CClass::SetText(<span class="keyword">const</span> std::string&amp; <a class="code hl_variable" href="../../d8/d4c/addon__base_8h.html#a6036ce391edec2455b498536dc4ea03d">value</a>) <span class="comment">// despite being declared as a reference, using string_view will result in a lower overhead in many cases (e.g., when passing a C string literal)</span></div>
<div class="line">{</div>
<div class="line">  CLog::LogF(<a class="code hl_variable" href="../../dc/d73/ilog_8h.html#a74224895f66cf67ff1ab4923f8c6f180">LOGDEBUG</a>, <span class="stringliteral">&quot;My name is {}&quot;</span>, <a class="code hl_variable" href="../../d8/d4c/addon__base_8h.html#a6036ce391edec2455b498536dc4ea03d">value</a>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">[...]</div>
<div class="line">SetText(CONSTANT_FOO.substr(0, 3)); <span class="comment">// using string_view will avoid a memory allocation due to substr</span></div>
</div><!-- fragment --><p><b>back to top</b> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Nov 7 2024 07:27:04 for Kodi Documentation by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
