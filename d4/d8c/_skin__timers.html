<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Kodi Documentation: Skin Timers</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Thumbnail-symbol-whitebg-small.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Kodi Documentation<span id="projectnumber">&#160;22.0</span>
   </div>
   <div id="projectbrief">Kodi is an open source media player and entertainment hub.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d4/d8c/_skin__timers.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Skin Timers</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#Skin_Timers_sect1">Description</a></li>
<li class="level1"><a href="#Skin_Timers_sect2">Examples</a></li>
<li class="level1"><a href="#Skin_Timers_sect3">Available tags</a></li>
<li class="level1"><a href="#Skin_Timers_sect4">See also</a><ul><ul><ul><li class="level4"><a href="#autotoc_md6">Development:</a></li>
</ul>
</ul>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p><b>Programatic time-based resources for Skins</b></p>
<hr  />
 <h1><a class="anchor" id="Skin_Timers_sect1"></a>
Description</h1>
<p>Skin timers are skin resources that are dependent on time and can be fully controlled from skins either using <a class="el" href="../../d0/d3e/page__list_of_built_in_functions.html"><b>Builtin functions</b></a> or <a class="el" href="../../d5/d11/modules__infolabels_boolean_conditions.html"><b>Infolabels and Boolean conditions</b></a>. One can see them as stopwatches that can be activated and deactivated automatically depending on the value of info expressions or simply activated/deactivated manually from builtins. The framework was created to allow skins to control the visibility of windows (and controls) depending on the elapsed time of timers the skin defines. Skin timers allow multiple use cases in skins, previously only available via the execution of python scripts:</p><ul>
<li>Closing a specific window after x seconds have elapsed</li>
<li>Controlling the visibility of a group (or triggering an animation) depending on the elapsed time of a given timer</li>
<li>Defining a buffer time window that is kept activated for a short period of time (e.g. keep controls visible for x seconds after a player seek)</li>
<li>Executing timed actions (on timer stop or timer start)</li>
<li>etc</li>
</ul>
<p>Skin timers are defined in the <code>Timers.xml</code> file within the xml directory of the skin. The file has the following "schema":</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">timers</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">timer</span>&gt;...&lt;/<span class="keywordtype">timer</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">timer</span>&gt;...&lt;/<span class="keywordtype">timer</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">timers</span>&gt;</div>
</div><!-- fragment --><p>see <a class="el" href="../../d4/d8c/_skin__timers.html#Skin_Timers_sect2">the examples section</a> and <a class="el" href="../../d4/d8c/_skin__timers.html#Skin_Timers_sect3">the list of available tags</a> for concrete details.</p>
<dl class="skinning_v20"><dt><b><a class="el" href="../../da/d4f/skinning_v20.html#_skinning_v20000001">v20 Skinning engine changes:</a></b></dt><dd>Added skin timers</dd></dl>
<hr  />
 <h1><a class="anchor" id="Skin_Timers_sect2"></a>
Examples</h1>
<p>The following example illustrates the simplest possible skin timer. This timer is completely manual (it has to be manually started and stopped):</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">timer</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">name</span>&gt;<span class="keyword">mymanualtimer</span>&lt;/<span class="keywordtype">name</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">description</span>&gt;100% <span class="keyword">manual</span> <span class="keyword">timer</span>&lt;/<span class="keywordtype">description</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">timer</span>&gt;</div>
</div><!-- fragment --><p>This timer can be controlled from your skin by executing the <a class="el" href="../../d0/d3e/page__list_of_built_in_functions.html#Builtin_SkinStartTimer"><code>Skin.TimerStart(mymanualtimer)</code> builtin</a> or <a class="el" href="../../d0/d3e/page__list_of_built_in_functions.html#Builtin_SkinStopTimer"><code>Skin.TimerStop(mymanualtimer)</code> builtin</a>. You can define the visibility of skin elements based on the internal properties of the timer, such as the fact that the timer is active/running using <a class="el" href="../../d5/d11/modules__infolabels_boolean_conditions.html#Skin_TimerIsRunning"><code>Skin.TimerIsRunning(mymanualtimer)</code> info</a> or depending on the elapsed time (e.g. 5 seconds) using the <a class="el" href="../../d5/d11/modules__infolabels_boolean_conditions.html#Skin_TimerElapsedSecs">Integer.IsGreaterOrEqual(Skin.TimerElapsedSecs(mymanualtimer),5) info</a>.</p>
<p>The following timer is a variation of the previous timer but with the added ability of being automatically stopped by the skinning engine after a maximum of elapsed 5 seconds without having to issue the <code>Skin.TimerStop(mymanualtimer)</code> builtin:</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">timer</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">name</span>&gt;<span class="keyword">mymanualautocloseabletimer</span>&lt;/<span class="keywordtype">name</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">description</span>&gt;100% <span class="keyword">manual</span> <span class="keyword">autocloseable</span> <span class="keyword">timer</span>&lt;/<span class="keywordtype">description</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">stop</span>&gt;<span class="keyword">Integer.IsGreaterOrEqual</span>(<span class="keyword">Skin.TimerElapsedSecs</span>(<span class="keyword">mymanualautocloseabletimer</span>),5)&lt;/<span class="keywordtype">stop</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">timer</span>&gt;</div>
</div><!-- fragment --><p>This type of timer is particularly useful if you want to automatically close a specific window (or triggering a close animation) after x time has elapsed, while guaranteeing the timer is also stopped. See the example below:</p>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">window</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;dialog&quot;</span> <span class="keyword">id</span>=<span class="stringliteral">&quot;1109&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">onload</span>&gt;<span class="keyword">Skin.TimerStart</span>(<span class="keyword">mymanualautocloseabletimer</span>)&lt;/<span class="keywordtype">onload</span>&gt;</div>
<div class="line">    ...</div>
<div class="line">  &lt;<span class="keywordtype">controls</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">control</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;group&quot;</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">animation</span> <span class="keyword">effect</span>=<span class="stringliteral">&quot;slide&quot;</span> <span class="keyword">start</span>=<span class="stringliteral">&quot;0,0&quot;</span> <span class="keyword">end</span>=<span class="stringliteral">&quot;0,-80&quot;</span> <span class="keyword">time</span>=<span class="stringliteral">&quot;300&quot;</span> <span class="keyword">condition</span>=<span class="stringliteral">&quot;Integer.IsGreaterOrEqual(Skin.TimerElapsedSecs(mymanualautocloseabletimer),5)&quot;</span>&gt;<span class="keyword">Conditional</span>&lt;/<span class="keywordtype">animation</span>&gt;</div>
<div class="line">      ...</div>
<div class="line">        &lt;/<span class="keywordtype">control</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">controls</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">window</span>&gt;</div>
</div><!-- fragment --><p>The following timer presents a notification (for 1 sec) whenever the timer is activated or deactivated:</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">timer</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">name</span>&gt;<span class="keyword">manualtimerwithactions</span>&lt;/<span class="keywordtype">name</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">description</span>&gt;100% <span class="keyword">manual</span> <span class="keyword">timer</span> <span class="keyword">with</span> <span class="keyword">actions</span>&lt;/<span class="keywordtype">description</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">onstart</span>&gt;<span class="keyword">Notification</span>(<span class="keyword">skintimer</span>, <span class="keyword">My</span> <span class="keyword">timer</span> <span class="keyword">was</span> <span class="keyword">started</span>, 1000)&lt;/<span class="keywordtype">onstart</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">onstop</span>&gt;<span class="keyword">Notification</span>(<span class="keyword">skintimer</span>, <span class="keyword">My</span> <span class="keyword">timer</span> <span class="keyword">was</span> <span class="keyword">stopped</span>, 1000)&lt;/<span class="keywordtype">onstop</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">timer</span>&gt;</div>
</div><!-- fragment --><p>The following timer is an example of a completely automatic timer. The timer is automatically activated or deactivated based on the value of boolean info expressions. In this particular example, the timer is automatically started whenever the Player is playing a file (if not already running). It is stopped if there is no file being played (and of course if previously running). Since the timer can be activated/deactivated multiple times, <code>reset="true"</code> ensures the timer is always reset to 0 on each start operation. Whenever the timer is started or stopped, notifications are issued.</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">timer</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">name</span>&gt;<span class="keyword">myautomatictimer</span>&lt;/<span class="keywordtype">name</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">description</span>&gt;<span class="keyword">Player</span> <span class="keyword">state</span> <span class="keyword">checker</span>&lt;/<span class="keywordtype">description</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">start</span> <span class="keyword">reset</span>=<span class="stringliteral">&quot;true&quot;</span>&gt;<span class="keyword">Player.Playing</span>&lt;/<span class="keywordtype">start</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">stop</span>&gt;!<span class="keyword">Player.Playing</span>&lt;/<span class="keywordtype">stop</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">onstart</span>&gt;<span class="keyword">Notification</span>(<span class="keyword">skintimer</span>, <span class="keyword">Player</span> <span class="keyword">has</span> <span class="keyword">started</span> <span class="keyword">playing</span> <span class="keyword">a</span> <span class="keyword">file</span>, 1000)&lt;/<span class="keywordtype">onstart</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">onstop</span>&gt;<span class="keyword">Notification</span>(<span class="keyword">skintimer</span>, <span class="keyword">Player</span> <span class="keyword">is</span> <span class="keyword">no</span> <span class="keyword">longer</span> <span class="keyword">playing</span> <span class="keyword">a</span> <span class="keyword">file</span>, 1000)&lt;/<span class="keywordtype">onstop</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">timer</span>&gt;</div>
</div><!-- fragment --><p>In certain situations you might want to reset your timer without having to stop and start. For instance, if you want to stop the timer after 5 seconds but have the timer resetting to 0 seconds if the user provides some input to Kodi. For such cases the <code>&lt;reset/&gt;</code> condition can be used:</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">timer</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">name</span>&gt;<span class="keyword">windowtimer</span>&lt;/<span class="keywordtype">name</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">description</span>&gt;<span class="keyword">Reset</span> <span class="keyword">on</span> <span class="keyword">idle</span>&lt;/<span class="keywordtype">description</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">start</span> <span class="keyword">reset</span>=<span class="stringliteral">&quot;true&quot;</span>&gt;<span class="keyword">Window.IsActive</span>(<span class="keyword">mywindow</span>)&lt;/<span class="keywordtype">start</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">reset</span>&gt;<span class="keyword">Window.IsActive</span>(<span class="keyword">mywindow</span>) + !<span class="keyword">System.IdleTime</span>(1) + <span class="keyword">Integer.IsGreaterOrEqual</span>(<span class="keyword">Skin.TimerElapsedSecs</span>(<span class="keyword">windowtimer</span>), 1)&lt;/<span class="keywordtype">reset</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">stop</span>&gt;!<span class="keyword">Window.IsActive</span>(<span class="keyword">mywindow</span>) + <span class="keyword">Integer.IsGreaterOrEqual</span>(<span class="keyword">Skin.TimerElapsedSecs</span>(<span class="keyword">windowtimer</span>), 5)&lt;/<span class="keywordtype">stop</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">onstop</span>&gt;<span class="keyword">Dialog.Close</span>(<span class="keyword">mywindow</span>)&lt;/<span class="keywordtype">onstop</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">timer</span>&gt;</div>
</div><!-- fragment --><p>Finer conditional granularity can also be applied to the <code>onstop</code> or <code>onstart</code> actions. This allows the skinner to create generic timers which respect a limited set of conditions but trigger different actions depending on a condition applied only to the action. The following timer plays the trailer of a given item when the user is in the videos window, the item has a trailer, the player is not playing and the global idle time is greater than 3 seconds. As you can see, the first action (notification) is triggered for any item. The actual playback, on the other hand, will only play if the focused item has the label "MyAwesomeMovie".</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">timer</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">name</span>&gt;<span class="keyword">trailer_autoplay_idle_timer</span>&lt;/<span class="keywordtype">name</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">start</span> <span class="keyword">reset</span>=<span class="stringliteral">&quot;true&quot;</span>&gt;<span class="keyword">System.IdleTime</span>(3) + <span class="keyword">Window.IsVisible</span>(<span class="keyword">videos</span>) + !<span class="keyword">Player.HasMedia</span> + !<span class="keyword">String.IsEmpty</span>(<span class="keyword">ListItem.Trailer</span>)&lt;/<span class="keywordtype">start</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">onstart</span>&gt;<span class="keyword">Notification</span>(<span class="keyword">skintimer</span> <span class="keyword">try</span> <span class="keyword">play</span>, $<span class="keyword">INFO</span>[<span class="keyword">ListItem.Trailer</span>], 1000)&lt;/<span class="keywordtype">onstart</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">onstart</span> <span class="keyword">condition</span>=<span class="stringliteral">&quot;String.IsEqual(ListItem.Label,MyAwesomeMovie)&quot;</span>&gt;<span class="keyword">PlayMedia</span>($<span class="keyword">INFO</span>[<span class="keyword">ListItem.Trailer</span>],1,<span class="keyword">noresume</span>)&lt;/<span class="keywordtype">onstart</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">timer</span>&gt;</div>
</div><!-- fragment --><hr  />
 <h1><a class="anchor" id="Skin_Timers_sect3"></a>
Available tags</h1>
<p>Skin timers have the following available tags:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Tag   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">name   </td><td class="markdownTableBodyLeft">The unique name of the timer. The name is used as the id of the timer, hence needs to be unique. <b>(required)</b>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">description   </td><td class="markdownTableBodyLeft">The description of the timer, a helper string. <b>(optional)</b>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">start   </td><td class="markdownTableBodyLeft">An info bool expression that the skinning engine should use to automatically start the timer <b>(optional)</b>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">reset   </td><td class="markdownTableBodyLeft">An info bool expression that the skinning engine should use to automatically reset the timer <b>(optional)</b>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">stop   </td><td class="markdownTableBodyLeft">An info bool expression that the skinning engine should use to automatically stop the timer <b>(optional)</b>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">onstart   </td><td class="markdownTableBodyLeft">A builtin function that the skinning engine should execute when the timer is started <b>(optional)</b><b>(can be repeated)</b>. Supports an additional <code>"condition"</code> as element attribute.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">onstop   </td><td class="markdownTableBodyLeft">A builtin function that the skinning engine should execute when the timer is stopped <b>(optional)</b><b>(can be repeated)</b>. Supports an additional <code>"condition"</code> as element attribute.   </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>If multiple onstart or onstop actions exist, their execution is triggered sequentially. </dd>
<dd>
Both onstart and onstop actions support fine-grained conditional granularity by specifying a "condition" attribute (see the examples above).</dd></dl>
<hr  />
 <h1><a class="anchor" id="Skin_Timers_sect4"></a>
See also</h1>
<h4><a class="anchor" id="autotoc_md6"></a>
Development:</h4>
<ul>
<li><a href="http://kodi.wiki/view/Skinning">Skinning</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/de7/skin_parts.html">Skin Development</a></li>
    <li class="footer">Generated on Thu Nov 7 2024 07:27:03 for Kodi Documentation by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
